# Linux Enumeration

## ğŸ” System Information

**Goal**: Identify OS, kernel, hardware to guide exploitation.

| Command | Purpose |
|--------|---------|
| `hostname` | Machine name |
| `cat /etc/issue` | Pre-login banner (distro hint) |
| `cat /etc/*release` | Full distro name/version (e.g., Ubuntu 20.04) |
| `uname -a` | Kernel version, arch, build time |
| `uname -r` | Kernel version only |
| `env` | Environment variables (PATH, USER, etc.) |
| `lscpu` | CPU architecture, cores, threads |
| `free -h` | RAM usage |
| `df -h` | Disk usage (all filesystems) |
| `df -ht ext4` | Only ext4 partitions |
| `lsblk \| grep sd` | Physical disks/partitions |
| `dpkg -l` | Installed packages (Debian/Ubuntu) |

> ğŸ’¡ **Key fields**:  
> 
> - **Kernel version** â†’ exploit compatibility (e.g., Dirty COW)  
> - **Distro** â†’ package manager (`rpm` vs `dpkg`)  
> - **Architecture** â†’ payload type (x86/x64)

---
## ğŸ‘¥ Users & Groups

**Goal**: Map accounts, privileges, and escalation paths.

|**Command**|**Purpose**|
|---|---|
|`whoami`|Displays the current username.|
|`groups`|Lists the groups the current user belongs to.|
|`groups <user>`|Lists the groups for a specific username.|
|`cat /etc/passwd`|Lists all users. **Interactive users** usually have `/bin/bash` or `/bin/sh`; **Service accounts** use `/usr/sbin/nologin` or `/bin/false`.|
|`who`|Shows users currently logged into the system (via TTY or SSH).|
|`last`|Displays a history of recent successful logins.|

> âš ï¸ **Linux vs Windows**:  
> 
> - **Linux**: Privileges via `sudo` group (not built-in "Administrators")  
> - **Windows**: Explicit admin groups (`Administrators`, `Domain Admins`)

---
## ğŸŒ Network Enumeration

**Goal**: Discover network layout, services, and neighbors.

| Command | Purpose |
|--------|---------|
| `ip a` or `ifconfig` | IP addresses, interfaces |
| `cat /etc/hostname` | Hostname |
| `cat /etc/hosts` | Static DNS mappings |
| `cat /etc/network/*` | Network config (Debian) |
| `route -n` | Routing table (gateway = `0.0.0.0`) |
| `netstat -tulpn` | Listening ports + PIDs |
| `arp -a` | Local network neighbors (recently contacted) |

> ğŸ’¡ **Critical for pivoting**:  
> 
> - Internal subnets â†’ route through this host  
> - Listening services â†’ lateral movement targets

---
## âš™ï¸ Processes & Cron Jobs

**Goal**: Find running services + scheduled tasks for privesc.

| Command | Purpose |
|--------|---------|
| `ps aux` | All processes (user, PID, command) |
| `top` | Real-time CPU/RAM usage |
| `crontab -l` | Current userâ€™s cron jobs |
| `ls -al /etc/cron*` | System-wide cron jobs |
| `cat /etc/crontab` | Global cron schedule |

> â“ **Why `crontab` works without installation?**  
> 
> - `crontab` is a **core utility** (part of `cron` daemon)  
> - If cron isnâ€™t installed, the command fails â€” but most servers have it enabled

---
## ğŸ¤– Automation Tools

### Manual Scripts

- **LinEnum** Scripted Local Linux Enumeration & Privilege Escalation Checks  

https://github.com/rebootuser/LinEnum
  
  â†’ Checks for:  
  - SUID misconfigs  
  - World-writable files  
  - Cron job exploits  
  - Docker/LXC containers  
  - Privs Esc

### Meterpreter Modules
| Module | Purpose |
|--------|---------|
| `post/linux/gather/enum_system` | OS, kernel, users |
| `post/linux/gather/enum_network` | IPs, routes, ARP table |
| `post/linux/gather/enum_configs` | Config files (SSH, Apache) |
| `post/linux/gather/checkvm` | Detect VM (VMware/Docker) |

> ğŸ’¡ **Pro Tip**:  
> Always run `LinEnum` first â†’ it highlights privesc vectors (SUID, cron, sudo rights)

---
## ğŸ—‚ï¸ Quick Reference Table

| Category | Critical Commands |
|----------|------------------|
| **System** | `uname -a`, `cat /etc/*release`, `lscpu` |
| **Users** | `id`, `cat /etc/passwd`, `groups` |
| **Network** | `ip a`, `netstat -tulpn`, `arp -a` |
| **Processes** | `ps aux`, `crontab -l`, `ls -al /etc/cron*` |
| **Automation** | LinEnum, `enum_system`, `checkvm` |

