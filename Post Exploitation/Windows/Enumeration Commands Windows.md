# Windows Enumeration

## üîç System Info

**Goal**: Identify OS, version, architecture, and patches to guide exploitation.

| Tool | Command | Output |
|------|---------|--------|
| **CMD** | `hostname` | Machine name |
|  | `systeminfo` | OS version, build, SP, architecture, hotfixes |
| **Meterpreter** | `sysinfo` | OS, arch, domain |
|  | `getuid` | Current user context |
|  | `getprivs` | Enabled privileges |

> üí° **Key fields**:  
> - **OS Name**: Windows 7/10/Server 2016  
> - **Build**: e.g., `19041` (Win10 20H1)  
> - **Architecture**: x86/x64  
> - **Hotfixes**: Missing patches = exploit opportunities

---
## üë• Users & Groups

**Goal**: Map accounts, privileges, and admin memberships.

| Command | Purpose |
|---------|---------|
| `whoami` | Current username |
| `whoami /priv` | Current privileges (e.g., `SeDebugPrivilege`) |
| `query user` | Currently logged-on users |
| `net users` | Local user accounts (non-domain) |
| `net user <name>` | User details (password expiry, groups) |
| `net localgroup` | Local groups (non-domain) |
| `net localgroup administrators` | Members of local admin group |

> ‚ö†Ô∏è **Domain vs Local**:  
> - `net users` = local accounts only  
> - For domain: `net users /domain`

---
## üåê Network Enumeration

**Goal**: Discover network layout, services, and neighbors.

| Command | Purpose |
|---------|---------|
| `ipconfig` | IP, subnet, gateway |
| `ipconfig /all` | + MAC, DHCP, DNS, domain info |
| `route print` | Routing table |
| `arp -a` | Recently contacted hosts (local network) |
| `netstat -ano` | Active connections/listening ports + PIDs |
| `netsh firewall show state` | Firewall status & open ports |

> üí° **Critical for pivoting**:  
> - Internal subnets ‚Üí `autoroute` in Meterpreter  
> - Listening services ‚Üí lateral movement targets

---
## ‚öôÔ∏è Processes & Services

**Goal**: Find stable processes for migration + privilege escalation paths.

| Tool | Command | Purpose |
|------|---------|---------|
| **Meterpreter** | `ps` | Running processes (shows owner) |
|  | `pgrep explorer` | Get PID of `explorer.exe` |
|  | `migrate <PID>` | Move session to stable process |
| **CMD** | `tasklist /svc` | Processes + their services |
|  | `net start` | Started services |
|  | `wmic service list brief` | All services (running/stopped) |
|  | `schtasks /query /fo list /v` | Scheduled tasks (check for SYSTEM tasks) |

> üîë **Why migrate?**  
> 
> - Prevents session loss if original process dies  
> - `explorer.exe` = always running, user context  
> - `lsass.exe` = SYSTEM privileges (requires prior elevation)

---
## ü§ñ Automation Tools

### Manual Scripts

- **JAWS**: PowerShell enum script  

https://github.com/411Hall/JAWS 

  ```powershell
  CMD C:\temp> powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1
  ```
  
  ‚Üí Automates all the above.
  
### Meterpreter Modules

| Module                                     | Purpose                                                      |
| ------------------------------------------ | ------------------------------------------------------------ |
| `post/windows/gather/win_privs`            | Local Admin group membership, UAC status, UID, and privilege |
| `post/windows/gather/enum_logged_on_users` | Logged-on users                                              |
| `post/windows/gather/checkvm`              | Detect VM (VMware/VirtualBox)                                |
| `post/windows/gather/enum_applications`    | Installed software (with versions)                           |
| `post/windows/gather/enum_computers`       | Domain computers                                             |
| `post/windows/gather/enum_patches`         | Missing patches (alternative to `systeminfo`)                |
| `post/windows/gather/enum_shares`          | SMB shares                                                   |

> üí° **Pro Tip**:  
> Always run `win_privs` first ‚Üí confirms if you‚Äôre admin/SYSTEM

---
## üóÇÔ∏è Quick Reference Table

| Category | Critical Commands |
|----------|------------------|
| **System** | `systeminfo`, `sysinfo` |
| **Users** | `whoami /priv`, `net localgroup administrators` |
| **Network** | `ipconfig /all`, `netstat -ano` |
| **Processes** | `ps`, `tasklist /svc`, `schtasks /query` |
| **Automation** | JAWS, `win_privs`, `enum_patches` |

