# Pentest Cheatsheet: Lester (local_exploit_suggester)

**Module**: `post/multi/recon/local_exploit_suggester`  
**Purpose**: Suggests local privesc exploits after low-priv access (Meterpreter/shell)  
**Best for**: Quick win in labs/CTFs (THM Blue, etc.)

### Usage (short)

```bash
background               # from session
use post/multi/recon/local_exploit_suggester
set SESSION 1
run
```

### Noise & Risk Comparison (2025–2026 reality)

| Action                              | Noise Level   | Triggers Alert? (real EDR/SOC) | Destructive?          |
|-------------------------------------|---------------|--------------------------------|-----------------------|
| `getsystem`                         | High          | Almost always                  | Yes (escalation)      |
| Actual exploit (e.g. bypassuac_*)   | Very High     | Yes + injection alerts         | Yes                   |
| **local_exploit_suggester**         | **Medium-High** | Often (behavioral)           | **No**                |
| Manual enum (whoami, systeminfo…)   | Low-Medium    | Sometimes                      | No                    |
| winPEAS / PowerUp.ps1               | High          | Very often                     | No                    |

### Key Notes

- **Safe to run** — only checks, no execution  
- **Loud in production** — hundreds of registry/file queries → EDR flags fast  
- **Labs**: Run first after initial access  
- **Real engagements**: Prefer manual enum or offline tools (WES-NG, Sherlock) for stealth  
- **Common lab winners**: bypassuac_*, juicypotato, printspoofer, rottenpotato

### Fast Lab Workflow

```
getuid → sysinfo → background → Lester → try first (+) result
```

## Best Practices in Labs / CTFs (e.g. THM Blue, BadByte)

1. Run Lester **immediately** after stable low-priv session
2. Note every + result → try them one by one
3. Common winners in old Windows labs:
    - bypassuac_* family (comhijack, fodhelper, sdclt, eventvwr, etc.)
    - ms10_015_kitrap0d, ms15_051, rottenpotato, juicypotato, printspoofer
4. If Lester finds nothing useful → run **getsystem**, check **ps**, **migrate** to better process, retry
5. Always check **sysinfo** first (arch, OS version, patches)
